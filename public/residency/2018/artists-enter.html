<script type="statebus">
dom.BODY = ->

  if (@loading)
    "Loading..."

  DIV
    style:
      textAlign: 'left'
      padding: '20px'
      marginBottom: '50px'
      font: "18px 'Muli', sans-serif"

    DIV
      style:
        fontWeight: 'bold'
        fontSize: '1.5em'
      'Enter the Artmaker'

    DIV
      style:
        color: "#B7B8BF"
      'A Statebus editor for artists for appearing on '
      A
        href: "http://invisible.college/residency/artists"
      "http://invisible.college/residency/artists"

    artists_list = fetch("/residency/artists") or {}

    if not artists_list.key?
      artists_list.key = "/residency/artists"
    if not artists_list.list?
      artists_list.list = []

    DIV
      style:
        margin: "10px"
        float: "clear"
      for artist in artists_list.list
        console.log(JSON.stringify(artist))
        if not artist.key?
          console.log("No entry key!")
        if not artist.name?
          console.log("No entry name")

        DIV
          style: null
          DIV
            style: float: "left"
            HEADER
              A
                href: artist.url
                artist.name
            IMG
              src: artist.photo
            P
              style:
                marginTop: '0px'
              artist.description
          I
            style:
              margin: "20px"
              float: "left"
            className: 'demo-icon icon-cancel-circled'
            onClick: (e) =>
              l = projects_list.list.slice()
              i = l.indexOf(project)
              l.splice(i,1)
              projects_list.list = l
              save(projects_list)
          DIV
            style:
              clear: "both"

    # Function to generate an entry form
    # tip: thing-in-progress, the object to build and save
    # entries: a list of objects of the form
    #   {key, name} where
    #     key is a string representing entry key which are also used in the div IDs
    #     name is the display name
    # name: string name for the thing to add
    entry_form = (tip, entries, name, listobj) ->
        DIV
            style:
                margin: "10px"
                float: "clear"
            entries.map (entry) ->
                if not entry.key?
                    console.log("No entry key!")
                if not entry.name?
                    console.log("No entry name")

                INPUT
                    type: 'text'
                    id: 'new_'+entry.key
                    # Construct the placeholder from the
                    # previous value-in-progress, or construct
                    # the name from the thing-in-progress + entry key
                    placeholder: (tip and tip[entry.key]) or name + " " + entry.name
                    onChange: (e) =>
                        tip[entry.key] = e.target.value;
                        save(tip);
            BUTTON
                id: 'submit'
                onClick: (e) =>
                    if not listobj.list?
                        listobj.list = []
                        listobj.lastId = 1
                    console.log("tip= " + JSON.stringify(tip))
                    listobj.list.push(tip)
                    listobj.lastId = listobj.lastId + 1
                    #del(tip)
                    save(listobj)
                "Add "+name

    # Artists-in-progress
    aip_entries = [
        {key: "name", name: "Name"},
        {key: "photo", name: "photo"}
        {key: "description", name: "Description"}
    ]
    aip = fetch("ls/aip") # member-in-progress
    entry_form(aip, aip_entries, "Artist", artists_list)

</script>

<!DOCTYPE html>
<html lang="en">

<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="http://invisible.college/favicon.ico">

  <title>Invisible College</title>

  <!-- Bootstrap core CSS -->
  <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts from femmebot.github.io/google-type -->

  <!-- Google web fonts for "The Astronomer" -->
  <link href='https://fonts.googleapis.com/css?family=Megrim|Roboto+Slab:300' rel='stylesheet' type='text/css'>

  <!-- Google web fonts for "The River" -->
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:800|Gentium+Basic:400,400italic' rel='stylesheet' type='text/css'>

  <link href='https://fonts.googleapis.com/css?family=Ovo|Muli:300' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="/css/cover.css" rel="stylesheet">
  <link href="/css/fontello.css" rel="stylesheet">
  <!--<link href="css/google-type.css" rel="stylesheet">-->

</head>

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

  <script src="https://stateb.us/client6.js" server=state://invisible.college></script>

</body>
</html>
